@using LMS.Web.Infrastructure;
@{
    UserProfile profile = Session["UserInfo"] as UserProfile;
    if (profile == null)
    {
        profile = new UserProfile
        {
            ClientName = "LMS",
            FirstName = "Guest",
            LastName = "User",
            UserId = -1
        };
    }

    ViewBag.Title = "Welcome " + profile.FirstName + " " + profile.LastName + ",";

    if (Layout.Contains("_Layout.super.admin.cshtml"))
    {
        @Html.Partial("_SuperAdmin")
    }
    if (Layout.Contains("_Layout.admin.cshtml"))
    {
        @Html.Partial("_Admin")
    }
    if (Layout.Contains("_Layout.user.cshtml"))
    {
        @Html.Partial("_User")
    }
}
@section scripts {
    <script src="~/Scripts/Site/DateLib.js"></script>
    <script type="text/javascript">
        var g;
        $(function () {
            $("#CourseContainer").hide();
            $.ajax({
                url: "@this.GetApiUrl()" + "/Courses/GetCoursesByUser/" + "@profile.UserId",
                beforeSend: function (request) {
                    request.setRequestHeader("Authorization", "Bearer " + "@this.GetToken()");
                },
                success: function (result) {
                    var courses = JSON.parse(result);
                    if (courses.length > 0)
                    {
                        $("#CourseContainer").show();
                        // this should be a loop foreach piece of e-learning
                        var course = courses[0];
                        g = course;
                        $("#CourseName").html(course.CourseName);
                        $("#CourseDescription").html(course.CourseDescription);
                        $("#CourseContent").attr("href", course.CourseContentResource);
                        $("#CourseContent").html(course.CourseContentName);
                        $("#CourseSessionId").val(course.CourseSessionId);
                        $("#CourseSessionStartDate").html(getDateFromJSONString(course.CourseSessionStartDate));
                        $("#CourseSessionEndDate").html(getDateFromJSONString(course.CourseSessionEndDate));
                    }                    
                }
            });
        });
    </script>
}

